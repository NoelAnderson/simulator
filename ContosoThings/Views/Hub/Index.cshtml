@using System.Web.Optimization
@{
    ViewBag.Title = "Hubs";
}

<h2>Hubs<small> Displays information about the hubs in the system</small></h2>

<div ng-app="mainApp" ng-controller="MainCtrl" class="main-app">
    <script type="text/ng-template" id="addThing.html">
        <div class="modal-header">
            <h3 class="modal-title" id="modal-title">Add Thing</h3>
        </div>
        <div class="modal-body" id="modal-body">
            <p>Name: <input ng-model="$ctrl.name" /></p>
            <p>
                Thing Type: 
                <select ng-model="$ctrl.thingType">
                    <option value="0">Switch</option>
                    <option value="1">Light (on/off)</option>
                    <option value="2">Light (on/off/dim)</option>
                    <option value="3">Light (on/off/dim/color)</option>
                </select>
            </p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" type="button" ng-click="$ctrl.ok()">OK</button>
            <button class="btn btn-warning" type="button" ng-click="$ctrl.cancel()">Cancel</button>
        </div>
    </script>

    <div class="ct-main-container">

        <div class="ct-left-panel" ng-if="hubs">
            <div class="ct-header-2">
                Hub List
            </div>

            <div class="ct-hub-list">
                <div ng-repeat="hub in hubs" class="ct-hub-list-item" ng-class="{'ct-hub-list-item-selected' : hub == hubDetail}">
                    <a href="#" ng-click="selectHub(hub);">{{hub.Name}} ({{hub.Things.length}})</a>
                </div>
            </div>
        </div>

        <div class="ct-hub-detail" ng-if="hubDetail">
            <div class="ct-header-2">
                {{hubDetail.Name}} 
                <small>({{hubDetail.Things.length}} things) - {{hubDetail.Id}}</small>
                <i ng-click="addThingShowDialog(hubDetail)" class="fa fa-plus" aria-hidden="true"></i>
                {{ selected }}
            </div>

            <div class="ct-thing-container">
                <div class="ct-thing" ng-repeat="thing in hubDetail.Things">
                    <div class="ct-thing-name">
                        {{thing.ThingsType}}: {{thing.Name}}
                    </div>
                    <div class="ct-action">
                        <div class="btn-group" data-toggle="buttons" ng-if="thing.ThingsType === 0 || thing.ThingsType === 1 || thing.ThingsType === 2">
                            <label class="btn btn-default" ng-class="{active:!thing.Switch}" ng-click="switchOff(hubDetail.Id, thing);">
                                <input type="radio" name="options" id="option1" autocomplete="off">Off
                            </label>
                            <label class="btn btn-default" ng-class="{active:thing.Switch}" ng-click="switchOn(hubDetail.Id, thing);">
                                <input type="radio" name="options" id="option2" autocomplete="off">On
                            </label>
                        </div>
                        <div ng-if="thing.ThingsType === 2">
                            <select ng-model="thing.Dim" ng-change="dim(hubDetail.Id, thing)">
                                <option ng-repeat="n in range(0, 100)">{{n}}</option>
                            </select>
                            <div class="text-xs-center dim-percentage" id="example-caption-2">{{thing.Dim}}%</div>
                            <progress class="progress" value="{{thing.Dim}}" max="100"></progress>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    
</div>

@section Scripts{
    @Scripts.Render("~/bundles/app")
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <script src="~/Scripts/app/index.js"></script>
}